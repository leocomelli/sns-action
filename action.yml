name: SNS Action
description: Publish a message on an SNS topic

branding:
  icon: document
  color: gray-dark

inputs:
  topic:
    required: true
    type: string
  mesasge:
    required: true
    type: string
  role:
    required: false
    type: string

outputs:
  messageId:
    description: "Unique identifier assigned to the published message"
    value: ${{ steps.publish.outputs.messageId }}

runs:
  using: "composite"

  steps:
    - name: Download sns-action
      uses: robinraju/release-downloader@v1.8
      with:
        repository: "leocomelli/sns-action"
        latest: true
        fileName: "sns-action"

    - name: Publish a message
      id: publish
      shell: bash
      run: |
        chmod +x sns-action
        ID=$(./sns-action \
          --topic "${{ inputs.topic }}" \
          --message "${{ inputs.message }}" \
          --role "${{ inputs.role }}")

        echo "messageId=$ID" >> $GITHUB_OUTPUT
